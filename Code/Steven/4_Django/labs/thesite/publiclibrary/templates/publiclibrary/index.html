<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Public Library Catalog</title>

    <style> body {
        min-height: 100vh;
    }
    body, .wrapper {
        display: flex;
        flex-direction: column;
        font-family: "Helvetica", "Arial", sans-serif;
        font-size: 14px;
        margin: 0;
    }
    .wrapper {
        flex: 1;
        /*grow to fill*/
    }
    main {
        flex: 1;
        /*grow to fill*/
    }
    sidebar {
        order: -1;
    }
    @media (min-width: 800px) {
        .wrapper {
            flex-direction: row;
        }
    }
    /* REGULAR, NON-FLEXBOX STYLES*/
    main {
        background: white;
    }
    header {
        background: grey;
        border-bottom: solid lightgrey;
        letter-spacing: .3em;
        font-weight: lighter;
        text-align: center;
        color: whitesmoke;
    }
    sidebar {
        background: grey;

    }
    .sidebar-header {
        color: white;
        text-align: center;
    }
    body > *, .wrapper > * {
        padding: .25em;
    }
    .wrapper {
        padding: 0;
    }

    /*TABLE STYLES*/
    table {
        border-collapse: collapse;
        width: 100%;
    }
    th, td {
        padding: 2px;
    }
    .table-book-list {
        border: .5px solid rgba(211, 211, 211, .5);
    }
    .table-book-list-header {
        background-color: #c8d0d3;
        color: white;
        border: 2px solid white;
        font-weight: lighter;
    }
    .table-sidebar {
        border: 0px;
        text-align: center;
    }
    .table-sidebar-header {
        border: 0px;
    }
    .table-cell-centered {
        text-align: center;
    }
    /*BUTTON STYLES*/
    .bt-no-border {
        padding: 0;
        margin: 0;
        border: none;
        background: none;
        font-size: 14px;
    }
    .bt-no-border:hover {
        color: whitesmoke;
    }

    .checked-out {
        color: darkgrey;
    }
    .checked-out-bt-clr {
        background: rgba(47, 150, 180, 0.47);
        transition: width 2s;
    }
    .input_field {
        width: 40%;
        align-items: left;
    }
    </style>

</head>
<body>


<header><h1>Public Library Catalog</h1></header>
<div class="wrapper">
    <main>

        <table>
            <tr class="table-book-list-header" >
                <th>Title</th>
                <th>Author</th>
                <th>Publish Date</th>
                <th>Checkout Date</th>
                <th></th>

            </tr>
            {%  for book in books %}
            <tr class="{% if book.checked_out %}checked-out{% else %}checked-in{% endif %}">

                <td>{{ book.title }}</td>
                <td>{{ book.author }}</td>
                <td class="table-cell-centered" >{{ book.publish_date|date:'Y-m-d' }}</td>
                <td class="table-cell-centered" >{{ book.checkedout_date|date:'Y-m-d H:i' }}</td>

                <td class="{% if book.checked_out %}checked-out-bt-clr{% endif %}">
                    {%  if book.checked_out %}
                    <form action="{% url 'publiclibrary:checkin_book' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="book_id" value="{{ book.id }}"/>
                        <input class="bt-no-border" type="submit" value="Check in"/>
                    </form>

                    {% else %}
                    <form action="{% url 'publiclibrary:checkout_book' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="book_id" value="{{ book.id }}"/>
                        <input class="bt-no-border" type="submit" value="Check out"/>
                    </form>
                    {% endif %}
                </td>

            </tr>
            {%  endfor %}

        </table>

    </main>


    <sidebar>
        <h2 class="sidebar-header" >Catalog Detail</h2>
        <table>

            <tr class="table-sidebar" >
                <th>Total</th>
                <th>Checked out</th>
                <th>Available</th>
                <th>Authors</th>
            </tr>

            <tr class="table-sidebar-header">
                <td>{{ cat_total }}</td>
                <td>{{ cat_in }}</td>
                <td>{{ cat_out }}</td>
                <td>{{ author_total }}</td>
            </tr>

        </table>

    </sidebar>
</div>

</body>
</html>